!function(){function e(){}function t(e,t,r){var o=r.context;r.success.call(o,e,"success",t),r.promise.resolve(e,"success",t),n("success",t,r)}function n(e,t,n){var r=n.context;n.complete.call(r,t,e)}function r(e,t,r,o){var a=o.context;o.error.call(a,r,t,e),o.promise.reject(r,t,e),n(t,r,o)}function o(n){function o(){u.clearAttributes?u.clearAttributes():u.onload=u.onreadystatechange=u.onerror=null,u.parentNode&&u.parentNode.removeChild(u),u=null,delete window[s]}var c,s=n.jsonpCallback||"jsonp"+(new Date).getTime(),u=window.document.createElement("script"),l={abort:function(){s in window&&(window[s]=e)}},p=window.document.getElementsByTagName("head")[0]||window.document.documentElement;return u.onerror=function(e){!function(e){window.clearTimeout(c),l.abort(),r(e.type,l,e.type,n),o()}(e)},window[s]=function(e){window.clearTimeout(c),t(e,l,n),o()},i(n),u.src=n.url.replace(/=\?/,"="+s),u.src=a(u.src,"_="+(new Date).getTime()),u.async=!0,n.scriptCharset&&(u.charset=n.scriptCharset),p.insertBefore(u,p.firstChild),n.timeout>0&&(c=window.setTimeout(function(){l.abort(),r("timeout",l,"timeout",n),o()},n.timeout)),n.promise}function a(e,t){return(e+"&"+t).replace(/[&?]{1,2}/,"?")}function i(e){u(e)&&!function(e){return e instanceof FormData}(e.data)&&e.processData&&(e.data=function(e,t){var n=[];return n.add=function(e,t){this.push(encodeURIComponent(e)+"="+encodeURIComponent(t))},c(n,e,t),n.join("&").replace("%20","+")}(e.data)),!e.data||e.type&&"GET"!==e.type.toUpperCase()||(e.url=a(e.url,e.data))}function c(e,t,n,r){var o=function(e){return"[object Array]"===Object.prototype.toString.call(e)}(t);for(var a in t){var i=t[a];r&&(a=n?r:r+"["+(o?"":a)+"]"),!r&&o?e.add(i.name,i.value):(n?o(i):u(i))?c(e,i,n,a):e.add(a,i)}}function s(e){for(var t=Array.prototype.slice.call(arguments,1),n=0,r=t.length;n<r;n++){var o=t[n]||{};for(var a in o)o.hasOwnProperty(a)&&void 0!==o[a]&&(e[a]=o[a])}return e}function u(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function l(e){return"function"==typeof e}var p="application/json",d="text/html",f=/^(?:text|application)\/xml/i,m=/^\s*$/,w={type:"GET",beforeSend:e,success:e,error:e,complete:e,context:null,xhr:function(){return new window.XMLHttpRequest},accepts:{json:p,xml:"application/xml, text/xml",html:d,text:"text/plain"},crossDomain:!1,timeout:0,username:null,password:null,processData:!0,promise:e,contentType:"application/x-www-form-urlencoded; charset=UTF-8"},y=function(n){var c=s({},n||{});for(var u in w)void 0===c[u]&&(c[u]=w[u]);try{var l={},y=new Promise(function(e,t){l.resolve=e,l.reject=t});y.resolve=l.resolve,y.reject=l.reject,c.promise=y}catch(t){c.promise={resolve:e,reject:e}}c.crossDomain||(c.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(c.url)&&RegExp.$2!==window.location.href);var v=c.dataType;if("jsonp"===v){if(!/=\?/.test(c.url)){var h=(c.jsonp||"callback")+"=?";c.url=a(c.url,h)}return o(c)}c.url||(c.url=window.location.toString()),i(c);var x,T=c.accepts[v],j={},b=(/^([\w-]+:)\/\//.test(c.url)?RegExp.$1:window.location.protocol,w.xhr());c.crossDomain||j["X-Requested-With"]||(j["X-Requested-With"]="XMLHttpRequest"),T&&(j.Accept=T,T.indexOf(",")>-1&&(T=T.split(",",2)[0]),b.overrideMimeType&&b.overrideMimeType(T));var g=!/^(?:GET|HEAD)$/.test(c.type.toUpperCase());(c.data&&g&&!1!==c.contentType||n.contentType)&&(j["Content-Type"]=c.contentType),c.headers=s(j,c.headers||{}),b.onreadystatechange=function(){if(4===b.readyState){clearTimeout(x);var e,n=!1;if(b.status>=200&&b.status<300||304===b.status){v=v||function(e){return e&&(e===d?"html":e===p?"json":f.test(e)&&"xml")||"text"}(b.getResponseHeader("content-type")),e=b.responseText;try{"xml"===v?e=b.responseXML:"json"===v&&(e=m.test(e)?null:JSON.parse(e))}catch(e){n=e}n?r(n,"parseerror",b,c):t(e,b,c)}else r(null,"error",b,c)}};var C=!("async"in c)||c.async;if(b.open(c.type,c.url,C,c.username,c.password),c.xhrFields)for(var D in c.xhrFields)b[D]=c.xhrFields[D];c.mimeType&&b.overrideMimeType&&b.overrideMimeType(c.mimeType);for(var D in c.headers)void 0!==c.headers[D]&&b.setRequestHeader(D,c.headers[D]+"");return!1===function(e,t){var n=t.context;if(!1===t.beforeSend.call(n,e,t))return!1}(b,c)?(b.abort(),!1):(c.timeout>0&&(x=window.setTimeout(function(){b.onreadystatechange=e,b.abort(),r(null,"timeout",b,c)},c.timeout)),b.send(c.data?c.data:null),c.promise.abort=function(){b.abort()},c.promise)};y.get=function(e,t,n,r){return l(t)&&(r=r||n,n=t,t=void 0),y({url:e,data:t,success:n,dataType:r})},y.post=function(e,t,n,r){return l(t)&&(r=r||n,n=t,t=void 0),y({type:"POST",url:e,data:t,success:n,dataType:r})},y.getJSON=function(e,t,n){return l(t)&&(n=t,t=void 0),y({url:e,data:t,success:n,dataType:"json"})},y.ajaxSetup=function(e,t){return t?s(s(e,w),t):s(w,e)},"function"==typeof define?define(function(){return y}):"undefined"!=typeof exports?module.exports=y:window.ajax=y}();